name: prestashop-fpm-example

services:
  prestashop:
    image: prestashop/prestashop:fpm-latest
    depends_on:
      mysql:
        condition: service_healthy
    environment:
      - PS_DOMAIN=localhost:8000
    expose:
      - 9000

  # TODO: fix link between prestashop & nginx (eg: static assets...)
  nginx:
    image: nginx:latest
    healthcheck:
      test: [ "CMD", "curl", "-is", "http://localhost:80" ]
      interval: 10s
      timeout: 10s
      retries: 5
    depends_on:
      prestashop:
        condition: service_healthy
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
    ports:
      - 8000:80
